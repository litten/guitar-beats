var Main=function(){var a,b,c=60,d=0,e=4,f=4,g=!0,h=!1,i=!0,j=!1,k="ontouchend"in document?"touchend":"click",l=$(".point"),m=$(".btn-status"),n=$(".circle-out"),o=$(".bpm-part"),p=$(".beat-part"),q=$(".setting-bpm-part"),r=$(".bpm-wording"),s=$(".ring"),t=$(".tape"),u=$(".pendulum"),v=$(".beat-and-note"),w=$(".beat-val"),x=$(".note-val"),y=function(b){if("undefined"!=typeof Audio)h?(a.src=b,a.play()):(a=new Audio(b),a.play(),h=!0);else if("undefined"!=typeof device){"Android"==device.platform&&console.log(b);var c=new Media(b,function(){c.release()},function(a){console.log("error playing sound: "+JSON.stringify(a))});c.play()}else alert("no sound API to play: "+b)},z=function(){d=0,l.css({"-webkit-transform":"rotate(0deg)"}),clearTimeout(b),m.removeClass("btn-pause").addClass("btn-play"),i=!0},A=function(){g?(d=(d+360/e)%360,l.css({"-webkit-transform":"rotate("+d+"deg)"}),0==d?(n.addClass("bg-orange"),setTimeout(function(){n.removeClass("bg-orange")},200),y("audio/1.ogg")):y("audio/2.ogg"),u.css({"-webkit-transform":"translate(0,60px)"})):u.css({"-webkit-transform":"translate(0,-60px)"}),g=!g},B=function(){l.bind(k,function(){$(this);i?(b=setInterval(A,3e4/c*4/f),m.removeClass("btn-play").addClass("btn-pause")):(clearTimeout(b),m.removeClass("btn-pause").addClass("btn-play")),i=!i}),o.bind(k,function(){j?(q.addClass("hide"),v.removeClass("hide"),p.removeClass("hide")):(p.addClass("hide"),v.addClass("hide"),q.removeClass("hide"),clearTimeout(b),m.removeClass("btn-pause").addClass("btn-play"),i=!0),j=!j}),w.bind(k,function(){var a=parseInt($(this).html()),b=a+1;b>f&&(b=2),e=b,$(this).html(b),z()}),x.bind(k,function(){var a=parseInt($(this).html()),b=2*a;b>16&&(b=4),f=b,$(this).html(b),z()}),s.bind("touchmove",function(a){var b=a.targetTouches[0].pageY;200>b?b=200:b>600&&(b=600),console.log(b),c=parseInt(Math.pow(b-200,2)/761.9+30),30>c?c=30:c>240&&(c=240),r.html(c),t.css({height:b-180})});var a=!1;s.bind("mousedown",function(){a=!0}),q.bind("mousemove",function(b){if(a){var d=b.clientY;200>d?d=200:d>600&&(d=600),console.log(d),c=parseInt(Math.pow(d-200,2)/761.9+30),30>c?c=30:c>240&&(c=240),r.html(c),t.css({height:d-180})}}),$(window).bind("mouseup",function(){a=!1})},C=function(){return{init:function(){var a=require("nw.gui"),b=a.Window.get();b.on("minimize",function(){z()}),b.on("restore",function(){b.resizeTo(350,600)})}}}();return{init:function(){B(),"function"==typeof require&&C.init()}}}();$(Main.init());